/*! For license information please see data-utils.js.LICENSE.txt */
!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define("DataUtils",[],t):"object"==typeof exports?exports.DataUtils=t():e.DataUtils=t()}(self,(()=>(()=>{"use strict";var e={5536:e=>{e.exports=function(e){var t,r={};if(!(e instanceof Object)||Array.isArray(e))throw new Error("keyMirror(...): Argument must be an object.");for(t in e)e.hasOwnProperty(t)&&(r[t]=t);return r}},2420:(e,t,r)=>{e.exports={Analyzer:r(740),DATA_TYPES:r(4384).DATA_TYPES,RegexList:r(1612)}},740:(e,t,r)=>{var n=r(4384),o=r(624),s=r(9544),i={_category:function(e){return n.TYPES_TO_CATEGORIES[e]||n.CATEGORIES.DIMENSION}},a={PAIR_GEOMETRY_FROM_STRING:!0,GEOMETRY_FROM_STRING:!0,NUMBER:!0},u={INT:!0,NUMBER:!0,FLOAT:!0};function l(e,t){e.push(t)}function c(){}i.computeColMeta=function(e,t,r){var h=(r=r||{}).ignoredDataTypes||[],f=r.keepUnknowns?l:c,d=n.VALIDATORS.filter((function(e){return this.indexOf(e)<0}),h);return e&&0!==Object.keys(e).length?Object.keys(e[0]).reduce((function(r,l){var c="",h=function(e,t){return(e||[]).reduce((function(e,r){return e||(r.name&&r.name===t||r.regex&&r.regex.test(t)?r.dataType:e)}),!1)}(t,l);h||(h=d.find(function(e,t){return function(r){var s=e.filter((function(e){return!function(e,t){return null===e||e===n.NULL||e===n.DB_NULL||void 0===e||!(!Number.isNaN(e)||!u[t])||!(""!==e||!a[t])}(e[t],r)})),i=o[r],l=Math.min(3,s.length),c=0;return s.some((function(e){return Boolean(i(e[t]))?c++:l--,l<=0})),l>0&&c>0}}(e,l)));var g=i._category(h),p={key:l,label:l,type:n.DATA_TYPES.STRING,category:g||n.CATEGORIES.DIMENSION,format:""};if(!h)return f(r,p),r;if(p.type=h,h&&-1!==n.TIME_VALIDATORS.indexOf(h)){var y=s.findFirstNonNullValue(e,l);if(null===y)return f(r,p),r;c=s.detectTimeFormat(y,h)}if(p.format=c,h===n.DATA_TYPES.GEOMETRY){var m=s.findFirstNonNullValue(e,l);if(null===m)return f(r,p),r;p.geoType="string"==typeof m.type?m.type.toUpperCase():null}if(h===n.DATA_TYPES.GEOMETRY_FROM_STRING){var T=s.findFirstNonNullValue(e,l);if(null===T)return f(r,p),r;p.geoType=T.split(" ")[0].toUpperCase()}return h===n.DATA_TYPES.PAIR_GEOMETRY_FROM_STRING&&(p.geoType="POINT"),r.push(p),r}),[]):[]},e.exports=i},4384:e=>{var t={DATA_TYPES:{DATE:"DATE",TIME:"TIME",DATETIME:"DATETIME",NUMBER:"NUMBER",INT:"INT",FLOAT:"FLOAT",CURRENCY:"CURRENCY",PERCENT:"PERCENT",STRING:"STRING",ZIPCODE:"ZIPCODE",BOOLEAN:"BOOLEAN",GEOMETRY:"GEOMETRY",GEOMETRY_FROM_STRING:"GEOMETRY_FROM_STRING",PAIR_GEOMETRY_FROM_STRING:"PAIR_GEOMETRY_FROM_STRING",NONE:"NONE",ARRAY:"ARRAY",DATE_OBJECT:"DATE_OBJECT",OBJECT:"OBJECT"},CATEGORIES:{GEOMETRY:"GEOMETRY",TIME:"TIME",DIMENSION:"DIMENSION",MEASURE:"MEASURE"},BOOLEAN_TRUE_VALUES:["true","yes"],BOOLEAN_FALSE_VALUES:["false","no"],DB_NULL:"\\N",NULL:"NULL",POSSIBLE_TYPES:{}};t.POSSIBLE_TYPES[t.CATEGORIES.GEOMETRY]=[t.DATA_TYPES.GEOMETRY_FROM_STRING,t.DATA_TYPES.PAIR_GEOMETRY_FROM_STRING,t.DATA_TYPES.GEOMETRY],t.POSSIBLE_TYPES[t.CATEGORIES.TIME]=[t.DATA_TYPES.DATETIME,t.DATA_TYPES.DATE,t.DATA_TYPES.TIME],t.POSSIBLE_TYPES[t.CATEGORIES.DIMENSION]=[t.DATA_TYPES.STRING,t.DATA_TYPES.BOOLEAN,t.DATA_TYPES.ZIPCODE],t.POSSIBLE_TYPES[t.CATEGORIES.MEASURE]=[t.DATA_TYPES.NUMBER,t.DATA_TYPES.INT,t.DATA_TYPES.FLOAT,t.DATA_TYPES.CURRENCY,t.DATA_TYPES.PERCENT],t.TYPES_TO_CATEGORIES=Object.keys(t.POSSIBLE_TYPES).reduce((function(e,r){return t.POSSIBLE_TYPES[r].forEach((function(t){e[t]=r})),e}),{}),t.VALIDATORS=[t.DATA_TYPES.GEOMETRY,t.DATA_TYPES.GEOMETRY_FROM_STRING,t.DATA_TYPES.PAIR_GEOMETRY_FROM_STRING,t.DATA_TYPES.BOOLEAN,t.DATA_TYPES.ARRAY,t.DATA_TYPES.DATE_OBJECT,t.DATA_TYPES.OBJECT,t.DATA_TYPES.CURRENCY,t.DATA_TYPES.PERCENT,t.DATA_TYPES.DATETIME,t.DATA_TYPES.DATE,t.DATA_TYPES.TIME,t.DATA_TYPES.INT,t.DATA_TYPES.FLOAT,t.DATA_TYPES.NUMBER,t.DATA_TYPES.ZIPCODE,t.DATA_TYPES.STRING],t.TIME_VALIDATORS=[t.DATA_TYPES.DATETIME,t.DATA_TYPES.DATE,t.DATA_TYPES.TIME],e.exports=t},1612:(e,t,r)=>{var n=r(6204),o={isNumber:/^(\+|\-)?\$?[\d,]*\.?\d+((e|E)(\+|\-)\d+)?%?$/,isInt:/^(\+|\-)?[\d,]+$/,isFloat:/^(\+|\-)?[\d,]*\.\d+?$/,isCurrency:/(?=.)^\$(([1-9][0-9]{0,2}(,[0-9]{3})*)|0)?(\.[0-9]{1,2})?$/,isPercentage:/^(\+|\-)?[\d,]*\.?\d+%$/,isZipCode:/(^\d{5}$)|(^\d{5}-\d{4}$)|(^\d{6}$)|(^\d{6}-\d{2}$)/,isTime:n.ALL_TIME_FORMAT_REGEX,isDate:n.DATE_FORMAT_REGEX,isDateTime:n.ALL_DATE_TIME_REGEX,isStringGeometry:/^(POINT|LINESTRING|POLYGON|MULTIPOINT|MULTILINESTRING|MULTIPOLYGON)/,isPairwisePointGeometry:/(\+|\-)?\d*\.\d*,( )?(\+|\-)?\d*\.\d*/,isObject:/^{([\s\S]*)}$/,isArray:/^\[([\s\S]*)\]$/};e.exports=o},6204:e=>{function t(e){return"("+e.join("|")+")"}var r="\\d{1,2}",n="\\d{1,2}",o="\\d{1,2}",s="\\d{1,2}",i="\\d{2}",a="(\\.\\d{1,6})",u="\\d{2}",l="(\\+|-)(\\d{4}|\\d{1,2}:\\d{2})",c="(am|pm)",h=["X","x","H:m","HH:mmZ","h:m a","H:m:s","h:m:s a","HH:mm:ssZZ","HH:mm:ss.SSSS","HH:mm:ss.SSSSZZ"].reverse(),f=["\\b\\d{12,13}\\b","\\b\\d{9,10}(\\.\\d{1,3})?\\b",n+":"+o,r+":"+u+"(\\+|-)\\d{1,2}:\\d{1,2}","\\d{1,2}:"+o+" "+c,n+":"+o+":"+s,n+":"+o+":"+s+" "+c,r+":"+u+":"+i+l,r+":"+u+":"+i+a,r+":"+u+":"+i+a+l].reverse(),d=h.reduce((function(e,t,r){return e[f[r]]=t,e}),{}),g=t(Object.keys(d)),p=new RegExp("^"+g+"$","i"),y="\\d{2,4}",m="\\d{1,2}",T=t(["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]),E=t(["January","February","March","April","May","June","July","August","September","October","November","December"]),A="\\d{1,2}",_="\\d{2}",b="\\d{1,2}(st|nd|rd|th)",w=[y+"-"+m+"-"+A,y+"\\/"+m+"\\/"+A,m+"\\/"+A+"\\/"+y,E+" "+_+", "+y,T+" "+_+", "+y,E+" "+b+", "+y,T+" "+b+", "+y],v=new RegExp("^"+t(w)+"$","i"),R=["YYYY-M-D","YYYY/M/D","M/D/YYYY","MMMM DD, YYYY","MMM DD, YYYY","MMMM Do, YYYY","MMM Do, YYYY"].reduce((function(e,t,r){return e[w[r]]=t,e}),{}),O=Object.keys(R).reduce((function(e,t){var r=R[t];return Object.keys(d).forEach((function(n){var o=d[n];e[t+" "+n]=r+" "+o,e[t+"T"+n]=r+"T"+o,e[n+"T"+t]=o+"T"+r,e[n+" "+t]=o+" "+r})),e}),{}),S=new RegExp(t(Object.keys(O)));e.exports={ALL_TIME_FORMAT_REGEX:p,TIME_FORMAT_REGEX_MAP:d,DATE_FORMAT_REGEX:v,DATE_FORMAT_REGEX_MAP:R,ALL_DATE_TIME_REGEX:S,DATE_TIME_MAP:O}},9544:(e,t,r)=>{var n=r(4384),o=r(1612),s=r(6204);function i(e,t){return function(r){if(e.test(r))for(var n=Object.keys(t),o=0;o<n.length;o++){var s=n[o],i=t[s];if(new RegExp(s).test(r))return i}return!1}}var a=i(s.ALL_TIME_FORMAT_REGEX,s.TIME_FORMAT_REGEX_MAP),u=i(s.DATE_FORMAT_REGEX,s.DATE_FORMAT_REGEX_MAP),l=i(s.ALL_DATE_TIME_REGEX,s.DATE_TIME_MAP);function c(e){let t;try{t=JSON.parse(e)}catch(e){return!1}return t}function h(e){return"string"==typeof e}function f(e){return e===Object(e)&&"function"!=typeof e&&!Array.isArray(e)}function d(e){return Array.isArray(e)}var g={buildRegexCheck:function(e){return function(t){return o[e].test(t.toString())}},detectTimeFormat:function(e,t){switch(t){case n.DATA_TYPES.DATETIME:return l(e);case n.DATA_TYPES.DATE:default:return u(e);case n.DATA_TYPES.TIME:return a(e)}},findFirstNonNullValue:function(e,t){for(var r=0;r<e.length;r++)if(null!==e[r][t]&&e[r][t]!==n.NULL)return e[r][t];return null},isBoolean:function(e){return n.BOOLEAN_TRUE_VALUES.concat(n.BOOLEAN_FALSE_VALUES).indexOf(String(e).toLowerCase())>-1},isGeographic:function(e){return Boolean(e)&&"object"==typeof e&&e.hasOwnProperty("type")&&e.hasOwnProperty("coordinates")},isString:h,isArray:function(e){return Boolean(d(e)||function(e){if(!h(e))return!1;if(!o.isArray.test(e))return!1;const t=c(e);return Boolean(t&&d(t))}(e))},isDateObject:function(e){return e instanceof Date},isObject:function(e){return Boolean(f(e)||function(e){if(!h(e))return!1;if(!o.isObject.test(e))return!1;const t=c(e);return Boolean(t&&f(t))}(e))},whichFormatTime:a,whichFormatDate:u,whichFormatDateTime:l};e.exports=g},624:(e,t,r)=>{var n=r(4384),o=r(9544),s=n.DATA_TYPES,i={};i[s.GEOMETRY]=o.isGeographic,i[s.GEOMETRY_FROM_STRING]=o.buildRegexCheck("isStringGeometry"),i[s.PAIR_GEOMETRY_FROM_STRING]=o.buildRegexCheck("isPairwisePointGeometry"),i[s.BOOLEAN]=o.isBoolean,i[s.DATE_OBJECT]=o.isDateObject,i[s.CURRENCY]=o.buildRegexCheck("isCurrency"),i[s.PERCENT]=o.buildRegexCheck("isPercentage"),i[s.ARRAY]=o.isArray,i[s.OBJECT]=o.isObject,i[s.DATETIME]=o.buildRegexCheck("isDateTime"),i[s.DATE]=o.buildRegexCheck("isDate"),i[s.TIME]=o.buildRegexCheck("isTime");const a=o.buildRegexCheck("isInt");function u(e){if(a(e)){var t=parseInt(e.toString().replace(/(\+|,)/g,""),10);return t>Number.MIN_SAFE_INTEGER&&t<Number.MAX_SAFE_INTEGER}return!1}i[s.INT]=u;const l=o.buildRegexCheck("isFloat");function c(e){return l(e)||u(e)}i[s.FLOAT]=c,i[s.NUMBER]=function(e){return!isNaN(e)||u(e)||c(e)},i[s.ZIPCODE]=o.buildRegexCheck("isZipCode"),i[s.STRING]=o.isString,e.exports=i}},t={};function r(n){var o=t[n];if(void 0!==o)return o.exports;var s=t[n]={exports:{}};return e[n](s,s.exports,r),s.exports}r.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return r.d(t,{a:t}),t},r.d=(e,t)=>{for(var n in t)r.o(t,n)&&!r.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},r.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var n={};return(()=>{r.r(n),r.d(n,{parseCSV:()=>Gt}),"undefined"!=typeof self&&self,"undefined"!=typeof window&&window,"undefined"!=typeof global&&global,"undefined"!=typeof document&&document;const e="object"!=typeof process||"[object process]"!==String(process)||process.browser,t="undefined"!=typeof window&&void 0!==window.orientation,o="undefined"!=typeof process&&process.version&&/v([0-9]*)/.exec(process.version);o&&parseFloat(o[1]);class s{terminate(){}}function i(e,t){if(!e)throw new Error(t||"loaders.gl assertion failed.")}const a=new Map;function u(e){const t=new Blob([e],{type:"application/javascript"});return URL.createObjectURL(t)}function l(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=arguments.length>2?arguments[2]:void 0;const n=r||new Set;if(e)if(c(e))n.add(e);else if(c(e.buffer))n.add(e.buffer);else if(ArrayBuffer.isView(e));else if(t&&"object"==typeof e)for(const r in e)l(e[r],t,n);return void 0===r?Array.from(n):[]}function c(e){return!!e&&(e instanceof ArrayBuffer||"undefined"!=typeof MessagePort&&e instanceof MessagePort||"undefined"!=typeof ImageBitmap&&e instanceof ImageBitmap||"undefined"!=typeof OffscreenCanvas&&e instanceof OffscreenCanvas)}const h=()=>{};class f{static isSupported(){return"undefined"!=typeof Worker&&e||void 0!==s&&!e}constructor(t){this.name=void 0,this.source=void 0,this.url=void 0,this.terminated=!1,this.worker=void 0,this.onMessage=void 0,this.onError=void 0,this._loadableURL="";const{name:r,source:n,url:o}=t;i(n||o),this.name=r,this.source=n,this.url=o,this.onMessage=h,this.onError=e=>console.log(e),this.worker=e?this._createBrowserWorker():this._createNodeWorker()}destroy(){this.onMessage=h,this.onError=h,this.worker.terminate(),this.terminated=!0}get isRunning(){return Boolean(this.onMessage)}postMessage(e,t){t=t||l(e),this.worker.postMessage(e,t)}_getErrorFromErrorEvent(e){let t="Failed to load ";return t+=`worker ${this.name} from ${this.url}. `,e.message&&(t+=`${e.message} in `),e.lineno&&(t+=`:${e.lineno}:${e.colno}`),new Error(t)}_createBrowserWorker(){this._loadableURL=function(e){i(e.source&&!e.url||!e.source&&e.url);let t=a.get(e.source||e.url);return t||(e.url&&(t=(r=e.url).startsWith("http")?u(`try {\n  importScripts('${r}');\n} catch (error) {\n  console.error(error);\n  throw error;\n}`):r,a.set(e.url,t)),e.source&&(t=u(e.source),a.set(e.source,t))),i(t),t;var r}({source:this.source,url:this.url});const e=new Worker(this._loadableURL,{name:this.name});return e.onmessage=e=>{e.data?this.onMessage(e.data):this.onError(new Error("No data received"))},e.onerror=e=>{this.onError(this._getErrorFromErrorEvent(e)),this.terminated=!0},e.onmessageerror=e=>console.error(e),e}_createNodeWorker(){let e;if(this.url){const t=this.url.includes(":/")||this.url.startsWith("/")?this.url:`./${this.url}`;e=new s(t,{eval:!1})}else{if(!this.source)throw new Error("no worker");e=new s(this.source,{eval:!0})}return e.on("message",(e=>{this.onMessage(e)})),e.on("error",(e=>{this.onError(e)})),e.on("exit",(e=>{})),e}}class d{constructor(e,t){this.name=void 0,this.workerThread=void 0,this.isRunning=!0,this.result=void 0,this._resolve=()=>{},this._reject=()=>{},this.name=e,this.workerThread=t,this.result=new Promise(((e,t)=>{this._resolve=e,this._reject=t}))}postMessage(e,t){this.workerThread.postMessage({source:"loaders.gl",type:e,payload:t})}done(e){i(this.isRunning),this.isRunning=!1,this._resolve(e)}error(e){i(this.isRunning),this.isRunning=!1,this._reject(e)}}class g{static isSupported(){return f.isSupported()}constructor(e){this.name="unnamed",this.source=void 0,this.url=void 0,this.maxConcurrency=1,this.maxMobileConcurrency=1,this.onDebug=()=>{},this.reuseWorkers=!0,this.props={},this.jobQueue=[],this.idleQueue=[],this.count=0,this.isDestroyed=!1,this.source=e.source,this.url=e.url,this.setProps(e)}destroy(){this.idleQueue.forEach((e=>e.destroy())),this.isDestroyed=!0}setProps(e){this.props={...this.props,...e},void 0!==e.name&&(this.name=e.name),void 0!==e.maxConcurrency&&(this.maxConcurrency=e.maxConcurrency),void 0!==e.maxMobileConcurrency&&(this.maxMobileConcurrency=e.maxMobileConcurrency),void 0!==e.reuseWorkers&&(this.reuseWorkers=e.reuseWorkers),void 0!==e.onDebug&&(this.onDebug=e.onDebug)}async startJob(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:(e,t,r)=>e.done(r),r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:(e,t)=>e.error(t);const n=new Promise((n=>(this.jobQueue.push({name:e,onMessage:t,onError:r,onStart:n}),this)));return this._startQueuedJob(),await n}async _startQueuedJob(){if(!this.jobQueue.length)return;const e=this._getAvailableWorker();if(!e)return;const t=this.jobQueue.shift();if(t){this.onDebug({message:"Starting job",name:t.name,workerThread:e,backlog:this.jobQueue.length});const r=new d(t.name,e);e.onMessage=e=>t.onMessage(r,e.type,e.payload),e.onError=e=>t.onError(r,e),t.onStart(r);try{await r.result}catch(e){console.error(`Worker exception: ${e}`)}finally{this.returnWorkerToQueue(e)}}}returnWorkerToQueue(t){!e||this.isDestroyed||!this.reuseWorkers||this.count>this._getMaxConcurrency()?(t.destroy(),this.count--):this.idleQueue.push(t),this.isDestroyed||this._startQueuedJob()}_getAvailableWorker(){if(this.idleQueue.length>0)return this.idleQueue.shift()||null;if(this.count<this._getMaxConcurrency()){this.count++;const e=`${this.name.toLowerCase()} (#${this.count} of ${this.maxConcurrency})`;return new f({name:e,source:this.source,url:this.url})}return null}_getMaxConcurrency(){return t?this.maxMobileConcurrency:this.maxConcurrency}}const p={maxConcurrency:3,maxMobileConcurrency:1,reuseWorkers:!0,onDebug:()=>{}};class y{static isSupported(){return f.isSupported()}static getWorkerFarm(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return y._workerFarm=y._workerFarm||new y({}),y._workerFarm.setProps(e),y._workerFarm}constructor(e){this.props=void 0,this.workerPools=new Map,this.props={...p},this.setProps(e),this.workerPools=new Map}destroy(){for(const e of this.workerPools.values())e.destroy();this.workerPools=new Map}setProps(e){this.props={...this.props,...e};for(const e of this.workerPools.values())e.setProps(this._getWorkerPoolProps())}getWorkerPool(e){const{name:t,source:r,url:n}=e;let o=this.workerPools.get(t);return o||(o=new g({name:t,source:r,url:n}),o.setProps(this._getWorkerPoolProps()),this.workerPools.set(t,o)),o}_getWorkerPoolProps(){return{maxConcurrency:this.props.maxConcurrency,maxMobileConcurrency:this.props.maxMobileConcurrency,reuseWorkers:this.props.reuseWorkers,onDebug:this.props.onDebug}}}y._workerFarm=void 0;const m="latest";null!==(T=globalThis._loadersgl_)&&void 0!==T&&T.version||(globalThis._loadersgl_=globalThis._loadersgl_||{},globalThis._loadersgl_.version="4.1.1"),globalThis._loadersgl_.version;var T;async function E(t,r,n,o,s){const a=t.id,u=function(t){let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const n=r[t.id]||{},o=e?`${t.id}-worker.js`:`${t.id}-worker-node.js`;let s=n.workerUrl;if(s||"compression"!==t.id||(s=r.workerUrl),"test"===r._workerType&&(s=e?`modules/${t.module}/dist/${o}`:`modules/${t.module}/src/workers/${t.id}-worker-node.ts`),!s){let e=t.version;"latest"===e&&(e=m);const r=e?`@${e}`:"";s=`https://unpkg.com/@loaders.gl/${t.module}${r}/dist/${o}`}return i(s),s}(t,n),l=y.getWorkerFarm(n).getWorkerPool({name:a,url:u});n=JSON.parse(JSON.stringify(n)),o=JSON.parse(JSON.stringify(o||{}));const c=await l.startJob("process-on-worker",A.bind(null,s));c.postMessage("process",{input:r,options:n,context:o});const h=await c.result;return await h.result}async function A(e,t,r,n){switch(r){case"done":t.done(n);break;case"error":t.error(new Error(n.error));break;case"process":const{id:o,input:s,options:i}=n;try{const r=await e(s,i);t.postMessage("done",{id:o,result:r})}catch(e){const r=e instanceof Error?e.message:"unknown error";t.postMessage("error",{id:o,error:r})}break;default:console.warn(`parse-with-worker unknown message ${r}`)}}function _(e,t){if(!e)throw new Error(t||"loader assertion failed.")}function b(e){var t;return!!e&&(Array.isArray(e)&&(e=e[0]),Array.isArray(null===(t=e)||void 0===t?void 0:t.extensions))}function w(e){var t,r;let n;return _(e,"null loader"),_(b(e),"invalid loader"),Array.isArray(e)&&(n=e[1],e=e[0],e={...e,options:{...e.options,...n}}),(null!==(t=e)&&void 0!==t&&t.parseTextSync||null!==(r=e)&&void 0!==r&&r.parseText)&&(e.text=!0),e.text||(e.binary=!0),e}const v=e=>"function"==typeof e,R=e=>null!==e&&"object"==typeof e,O=e=>R(e)&&e.constructor==={}.constructor,S=e=>Boolean(e)&&"function"==typeof e[Symbol.iterator],M=e=>e&&"function"==typeof e[Symbol.asyncIterator],C=e=>"undefined"!=typeof Response&&e instanceof Response||e&&e.arrayBuffer&&e.text&&e.json,D=e=>"undefined"!=typeof Blob&&e instanceof Blob,I=e=>e&&"object"==typeof e&&e.isBuffer,k=e=>(e=>"undefined"!=typeof ReadableStream&&e instanceof ReadableStream||R(e)&&v(e.tee)&&v(e.cancel)&&v(e.getReader))(e)||(e=>R(e)&&v(e.read)&&v(e.pipe)&&(e=>"boolean"==typeof e)(e.readable))(e);function x(){return!("object"==typeof process&&"[object process]"===String(process)&&!process.browser)||function(e){if("undefined"!=typeof window&&"object"==typeof window.process&&"renderer"===window.process.type)return!0;if("undefined"!=typeof process&&"object"==typeof process.versions&&Boolean(process.versions.electron))return!0;const t="object"==typeof navigator&&"string"==typeof navigator.userAgent&&navigator.userAgent;return!!(t&&t.indexOf("Electron")>=0)}()}const N="undefined"!=typeof __VERSION__?__VERSION__:"untranspiled source";x();class P{constructor(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"sessionStorage";this.storage=void 0,this.id=void 0,this.config=void 0,this.storage=function(e){try{const t=window[e],r="__storage_test__";return t.setItem(r,r),t.removeItem(r),t}catch(e){return null}}(r),this.id=e,this.config=t,this._loadConfiguration()}getConfiguration(){return this.config}setConfiguration(e){if(Object.assign(this.config,e),this.storage){const e=JSON.stringify(this.config);this.storage.setItem(this.id,e)}}_loadConfiguration(){let e={};if(this.storage){const t=this.storage.getItem(this.id);e=t?JSON.parse(t):{}}return Object.assign(this.config,e),this}}function L(e,t,r){let n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:600;const o=e.src.replace(/\(/g,"%28").replace(/\)/g,"%29");e.width>n&&(r=Math.min(r,n/e.width));const s=e.width*r,i=e.height*r;return[`${t} %c+`,["font-size:1px;",`padding:${Math.floor(i/2)}px ${Math.floor(s/2)}px;`,`line-height:${i}px;`,`background:url(${o});`,`background-size:${s}px ${i}px;`,"color:transparent;"].join("")]}let B;!function(e){e[e.BLACK=30]="BLACK",e[e.RED=31]="RED",e[e.GREEN=32]="GREEN",e[e.YELLOW=33]="YELLOW",e[e.BLUE=34]="BLUE",e[e.MAGENTA=35]="MAGENTA",e[e.CYAN=36]="CYAN",e[e.WHITE=37]="WHITE",e[e.BRIGHT_BLACK=90]="BRIGHT_BLACK",e[e.BRIGHT_RED=91]="BRIGHT_RED",e[e.BRIGHT_GREEN=92]="BRIGHT_GREEN",e[e.BRIGHT_YELLOW=93]="BRIGHT_YELLOW",e[e.BRIGHT_BLUE=94]="BRIGHT_BLUE",e[e.BRIGHT_MAGENTA=95]="BRIGHT_MAGENTA",e[e.BRIGHT_CYAN=96]="BRIGHT_CYAN",e[e.BRIGHT_WHITE=97]="BRIGHT_WHITE"}(B||(B={}));function Y(e){return"string"!=typeof e?e:(e=e.toUpperCase(),B[e]||B.WHITE)}function j(e,t){if(!e)throw new Error(t||"Assertion failed")}globalThis.self||globalThis.window||globalThis.global;const G=globalThis.window||globalThis.self||globalThis.global,F=(globalThis.document,globalThis.process||{});function $(){let e;var t,r;if(x()&&G.performance)e=null==G||null===(t=G.performance)||void 0===t||null===(r=t.now)||void 0===r?void 0:r.call(t);else if("hrtime"in F){var n;const t=null==F||null===(n=F.hrtime)||void 0===n?void 0:n.call(F);e=1e3*t[0]+t[1]/1e6}else e=Date.now();return e}globalThis.console,globalThis.navigator;const U={debug:x()&&console.debug||console.log,log:console.log,info:console.info,warn:console.warn,error:console.error},W={enabled:!0,level:0};function H(){}const J={},V={once:!0};class z{constructor(){let{id:e}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{id:""};this.id=void 0,this.VERSION=N,this._startTs=$(),this._deltaTs=$(),this._storage=void 0,this.userData={},this.LOG_THROTTLE_TIMEOUT=0,this.id=e,this.userData={},this._storage=new P(`__probe-${this.id}__`,W),this.timeStamp(`${this.id} started`),function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:["constructor"];const r=Object.getPrototypeOf(e),n=Object.getOwnPropertyNames(r),o=e;for(const r of n){const n=o[r];"function"==typeof n&&(t.find((e=>r===e))||(o[r]=n.bind(e)))}}(this),Object.seal(this)}set level(e){this.setLevel(e)}get level(){return this.getLevel()}isEnabled(){return this._storage.config.enabled}getLevel(){return this._storage.config.level}getTotal(){return Number(($()-this._startTs).toPrecision(10))}getDelta(){return Number(($()-this._deltaTs).toPrecision(10))}set priority(e){this.level=e}get priority(){return this.level}getPriority(){return this.level}enable(){let e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return this._storage.setConfiguration({enabled:e}),this}setLevel(e){return this._storage.setConfiguration({level:e}),this}get(e){return this._storage.config[e]}set(e,t){this._storage.setConfiguration({[e]:t})}settings(){console.table?console.table(this._storage.config):console.log(this._storage.config)}assert(e,t){j(e,t)}warn(e){return this._getLogFunction(0,e,U.warn,arguments,V)}error(e){return this._getLogFunction(0,e,U.error,arguments)}deprecated(e,t){return this.warn(`\`${e}\` is deprecated and will be removed in a later version. Use \`${t}\` instead`)}removed(e,t){return this.error(`\`${e}\` has been removed. Use \`${t}\` instead`)}probe(e,t){return this._getLogFunction(e,t,U.log,arguments,{time:!0,once:!0})}log(e,t){return this._getLogFunction(e,t,U.debug,arguments)}info(e,t){return this._getLogFunction(e,t,console.info,arguments)}once(e,t){return this._getLogFunction(e,t,U.debug||U.info,arguments,V)}table(e,t,r){return t?this._getLogFunction(e,t,console.table||H,r&&[r],{tag:Z(t)}):H}image(e){let{logLevel:t,priority:r,image:n,message:o="",scale:s=1}=e;return this._shouldLog(t||r)?x()?function(e){let{image:t,message:r="",scale:n=1}=e;if("string"==typeof t){const e=new Image;return e.onload=()=>{const t=L(e,r,n);console.log(...t)},e.src=t,H}const o=t.nodeName||"";if("img"===o.toLowerCase())return console.log(...L(t,r,n)),H;if("canvas"===o.toLowerCase()){const e=new Image;return e.onload=()=>console.log(...L(e,r,n)),e.src=t.toDataURL(),H}return H}({image:n,message:o,scale:s}):function(e){let{image:t,message:r="",scale:n=1}=e;return console.warn("removed"),H}({image:n,message:o,scale:s}):H}time(e,t){return this._getLogFunction(e,t,console.time?console.time:console.info)}timeEnd(e,t){return this._getLogFunction(e,t,console.timeEnd?console.timeEnd:console.info)}timeStamp(e,t){return this._getLogFunction(e,t,console.timeStamp||H)}group(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{collapsed:!1};const n=Q({logLevel:e,message:t,opts:r}),{collapsed:o}=r;return n.method=(o?console.groupCollapsed:console.group)||console.info,this._getLogFunction(n)}groupCollapsed(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return this.group(e,t,Object.assign({},r,{collapsed:!0}))}groupEnd(e){return this._getLogFunction(e,"",console.groupEnd||H)}withGroup(e,t,r){this.group(e,t)();try{r()}finally{this.groupEnd(e)()}}trace(){console.trace&&console.trace()}_shouldLog(e){return this.isEnabled()&&this.getLevel()>=q(e)}_getLogFunction(e,t,r,n,o){if(this._shouldLog(e)){o=Q({logLevel:e,message:t,args:n,opts:o}),j(r=r||o.method),o.total=this.getTotal(),o.delta=this.getDelta(),this._deltaTs=$();const s=o.tag||o.message;if(o.once&&s){if(J[s])return H;J[s]=$()}return t=function(e,t,r){if("string"==typeof t){const i=r.time?function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:8;const r=Math.max(t-e.length,0);return`${" ".repeat(r)}${e}`}(function(e){let t;return t=e<10?`${e.toFixed(2)}ms`:e<100?`${e.toFixed(1)}ms`:e<1e3?`${e.toFixed(0)}ms`:`${(e/1e3).toFixed(2)}s`,t}(r.total)):"";n=t=r.time?`${e}: ${i}  ${t}`:`${e}: ${t}`,o=r.color,s=r.background,x||"string"!=typeof n||(o&&(n=`[${Y(o)}m${n}[39m`),s&&(n=`[${Y(s)+10}m${n}[49m`)),t=n}var n,o,s;return t}(this.id,o.message,o),r.bind(console,t,...o.args)}return H}}function q(e){if(!e)return 0;let t;switch(typeof e){case"number":t=e;break;case"object":t=e.logLevel||e.priority||0;break;default:return 0}return j(Number.isFinite(t)&&t>=0),t}function Q(e){const{logLevel:t,message:r}=e;e.logLevel=q(t);const n=e.args?Array.from(e.args):[];for(;n.length&&n.shift()!==r;);switch(typeof t){case"string":case"function":void 0!==r&&n.unshift(r),e.message=t;break;case"object":Object.assign(e,t)}"function"==typeof e.message&&(e.message=e.message());const o=typeof e.message;return j("string"===o||"object"===o),Object.assign(e,{args:n},e.opts)}function Z(e){for(const t in e)for(const r in e[t])return r||"untitled";return"empty"}z.VERSION=N;const X=new z({id:"loaders.gl"});class K{log(){return()=>{}}info(){return()=>{}}warn(){return()=>{}}error(){return()=>{}}}"undefined"!=typeof self&&self,"undefined"!=typeof window&&window,"undefined"!=typeof global&&global,"undefined"!=typeof document&&document;const ee=Boolean("object"!=typeof process||"[object process]"!==String(process)||process.browser),te="undefined"!=typeof process&&process.version&&/v([0-9]*)/.exec(process.version),re=(te&&parseFloat(te[1]),{fetch:null,mimeType:void 0,nothrow:!1,log:new class{constructor(){this.console=void 0,this.console=console}log(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return this.console.log.bind(this.console,...t)}info(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return this.console.info.bind(this.console,...t)}warn(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return this.console.warn.bind(this.console,...t)}error(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return this.console.error.bind(this.console,...t)}},useLocalLibraries:!1,CDN:"https://unpkg.com/@loaders.gl",worker:!0,maxConcurrency:3,maxMobileConcurrency:1,reuseWorkers:ee,_nodeWorkers:!1,_workerType:"",limit:0,_limitMB:0,batchSize:"auto",batchDebounceMs:0,metadata:!1,transforms:[]}),ne={throws:"nothrow",dataType:"(no longer used)",uri:"baseUri",method:"fetch.method",headers:"fetch.headers",body:"fetch.body",mode:"fetch.mode",credentials:"fetch.credentials",cache:"fetch.cache",redirect:"fetch.redirect",referrer:"fetch.referrer",referrerPolicy:"fetch.referrerPolicy",integrity:"fetch.integrity",keepalive:"fetch.keepalive",signal:"fetch.signal"};function oe(){globalThis.loaders=globalThis.loaders||{};const{loaders:e}=globalThis;return e._state=e._state||{},e._state}function se(){const e=oe();return e.globalOptions=e.globalOptions||{...re},e.globalOptions}function ie(e,t,r,n){return r=r||[],function(e,t){ae(e,null,re,ne,t);for(const r of t){const n=e&&e[r.id]||{},o=r.options&&r.options[r.id]||{},s=r.deprecatedOptions&&r.deprecatedOptions[r.id]||{};ae(n,r.id,o,s,t)}}(e,r=Array.isArray(r)?r:[r]),function(e,t,r){const n={...e.options||{}};return function(e,t){t&&!("baseUri"in e)&&(e.baseUri=t)}(n,r),null===n.log&&(n.log=new K),le(n,se()),le(n,t),n}(t,e,n)}function ae(e,t,r,n,o){const s=t||"Top level",i=t?`${t}.`:"";for(const a in e){const u=!t&&R(e[a]);if(!(a in r)&&("baseUri"!==a||t)&&("workerUrl"!==a||!t))if(a in n)X.warn(`${s} loader option '${i}${a}' no longer supported, use '${n[a]}'`)();else if(!u){const e=ue(a,o);X.warn(`${s} loader option '${i}${a}' not recognized. ${e}`)()}}}function ue(e,t){const r=e.toLowerCase();let n="";for(const o of t)for(const t in o.options){if(e===t)return`Did you mean '${o.id}.${t}'?`;const s=t.toLowerCase();(r.startsWith(s)||s.startsWith(r))&&(n=n||`Did you mean '${o.id}.${t}'?`)}return n}function le(e,t){for(const r in t)if(r in t){const n=t[r];O(n)&&O(e[r])?e[r]={...e[r],...t[r]}:e[r]=t[r]}}function ce(e,t){return he(e||{},t)}function he(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;if(r>3)return t;const n={...e};for(const[e,o]of Object.entries(t))o&&"object"==typeof o&&!Array.isArray(o)?n[e]=he(n[e]||{},t[e],r+1):n[e]=t[e];return n}const fe=262144,de=262144,ge=1048576;function pe(e){if((t=e)&&"object"==typeof t&&t.isBuffer)return e;var t;if(e instanceof ArrayBuffer)return e;if(ArrayBuffer.isView(e))return 0===e.byteOffset&&e.byteLength===e.buffer.byteLength?e.buffer:e.buffer.slice(e.byteOffset,e.byteOffset+e.byteLength);if("string"==typeof e){const t=e;return(new TextEncoder).encode(t).buffer}if(e&&"object"==typeof e&&e._toArrayBuffer)return e._toArrayBuffer();throw new Error("toArrayBuffer")}function ye(e,t){return ee?async function*(e,t){const r=e.getReader();let n;try{for(;;){const e=n||r.read();null!=t&&t._streamReadAhead&&(n=r.read());const{done:o,value:s}=await e;if(o)return;yield pe(s)}}catch(e){r.releaseLock()}}(e,t):async function*(e,t){for await(const t of e)yield pe(t)}(e)}const me=/^data:([-\w.]+\/[-\w.+]+)(;|,)/,Te=/^([-\w.]+\/[-\w.+]+)/;function Ee(e){const t=me.exec(e);return t?t[1]:""}const Ae=/\?.*/;function _e(e){return e.replace(Ae,"")}function be(e){return C(e)?e.url:D(e)?e.name||"":"string"==typeof e?e:""}function we(e){if(C(e)){const t=e,r=t.headers.get("content-type")||"",n=_e(t.url);return function(e){const t=Te.exec(e);return t?t[1]:e}(r)||Ee(n)}return D(e)?e.type||"":"string"==typeof e?Ee(e):""}async function ve(e){if(C(e))return e;const t={},r=function(e){return C(e)?e.headers["content-length"]||-1:D(e)?e.size:"string"==typeof e?e.length:e instanceof ArrayBuffer||ArrayBuffer.isView(e)?e.byteLength:-1}(e);r>=0&&(t["content-length"]=String(r));const n=be(e),o=we(e);o&&(t["content-type"]=o);const s=await async function(e){if("string"==typeof e)return`data:,${e.slice(0,5)}`;if(e instanceof Blob){const t=e.slice(0,5);return await new Promise((e=>{const r=new FileReader;r.onload=t=>{var r;return e(null==t||null===(r=t.target)||void 0===r?void 0:r.result)},r.readAsDataURL(t)}))}return e instanceof ArrayBuffer?`data:base64,${function(e){let t="";const r=new Uint8Array(e);for(let e=0;e<r.byteLength;e++)t+=String.fromCharCode(r[e]);return btoa(t)}(e.slice(0,5))}`:null}(e);s&&(t["x-first-bytes"]=s),"string"==typeof e&&(e=(new TextEncoder).encode(e));const i=new Response(e,{headers:t});return Object.defineProperty(i,"url",{value:n}),i}const Re="Cannot convert supplied data type";async function Oe(e,t,r){const n=e instanceof ArrayBuffer||ArrayBuffer.isView(e);if("string"==typeof e||n)return function(e,t,r){if(t.text&&"string"==typeof e)return e;if(I(e)&&(e=e.buffer),e instanceof ArrayBuffer){const r=e;return t.text&&!t.binary?new TextDecoder("utf8").decode(r):r}if(ArrayBuffer.isView(e)){if(t.text&&!t.binary)return new TextDecoder("utf8").decode(e);let r=e.buffer;const n=e.byteLength||e.length;return 0===e.byteOffset&&n===r.byteLength||(r=r.slice(e.byteOffset,e.byteOffset+n)),r}throw new Error(Re)}(e,t);if(D(e)&&(e=await ve(e)),C(e)){const r=e;return await async function(e){if(!e.ok){const t=await async function(e){let t=`Failed to fetch resource ${e.url} (${e.status}): `;try{const r=e.headers.get("Content-Type");let n=e.statusText;null!=r&&r.includes("application/json")&&(n+=` ${await e.text()}`),t+=n,t=t.length>60?`${t.slice(0,60)}...`:t}catch(e){}return t}(e);throw new Error(t)}}(r),t.binary?await r.arrayBuffer():await r.text()}if(k(e)&&(e=function(e,t){if("string"==typeof e)return function*(e,t){const r=(null==t?void 0:t.chunkSize)||fe;let n=0;const o=new TextEncoder;for(;n<e.length;){const t=Math.min(e.length-n,r),s=e.slice(n,n+t);n+=t,yield o.encode(s)}}(e,t);if(e instanceof ArrayBuffer)return function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return function*(){const{chunkSize:r=de}=t;let n=0;for(;n<e.byteLength;){const t=Math.min(e.byteLength-n,r),o=new ArrayBuffer(t),s=new Uint8Array(e,n,t);new Uint8Array(o).set(s),n+=t,yield o}}()}(e,t);if(D(e))return async function*(e,t){const r=(null==t?void 0:t.chunkSize)||ge;let n=0;for(;n<e.size;){const t=n+r,o=await e.slice(n,t).arrayBuffer();n=t,yield o}}(e,t);if(k(e))return ye(e,t);if(C(e))return ye(e.body,t);throw new Error("makeIterator")}(e,r)),S(e)||M(e))return async function(e){const t=[];for await(const r of e)t.push(r);return function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return function(e){const t=e.map((e=>e instanceof ArrayBuffer?new Uint8Array(e):e)),r=t.reduce(((e,t)=>e+t.byteLength),0),n=new Uint8Array(r);let o=0;for(const e of t)n.set(e,o),o+=e.byteLength;return n.buffer}(t)}(...t)}(e);throw new Error(Re)}let Se="";const Me={};async function Ce(e,t){if("string"==typeof e){const o=function(e){for(const t in Me)if(e.startsWith(t)){const r=Me[t];e=e.replace(t,r)}return e.startsWith("http://")||e.startsWith("https://")||(e=`${Se}${e}`),e}(e);var r,n;return function(e){return!function(e){return e.startsWith("http:")||e.startsWith("https:")}(e)&&!function(e){return e.startsWith("data:")}(e)}(o)&&null!==(r=globalThis.loaders)&&void 0!==r&&r.fetchNode?null===(n=globalThis.loaders)||void 0===n?void 0:n.fetchNode(o,t):await fetch(o,t)}return await ve(e)}function De(e,t){const r=se(),n=e||r;return"function"==typeof n.fetch?n.fetch:R(n.fetch)?e=>Ce(e,n.fetch):null!=t&&t.fetch?null==t?void 0:t.fetch:Ce}function Ie(e){const t=e?e.lastIndexOf("/"):-1;return t>=0?e.substr(t+1):""}const ke=new z({id:"loaders.gl"}),xe=()=>{const e=oe();return e.loaderRegistry=e.loaderRegistry||[],e.loaderRegistry},Ne=/\.([^.]+)$/;function Pe(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],r=arguments.length>2?arguments[2]:void 0,n=arguments.length>3?arguments[3]:void 0;if(!Le(e))return null;if(t&&!Array.isArray(t))return w(t);let o=[];t&&(o=o.concat(t)),null!=r&&r.ignoreRegisteredLoaders||o.push(...xe()),function(e){for(const t of e)w(t)}(o);const s=function(e,t,r,n){const o=be(e),s=we(e),i=_e(o)||(null==n?void 0:n.url);let a=null,u="";var l;return null!=r&&r.mimeType&&(a=Ye(t,null==r?void 0:r.mimeType),u=`match forced by supplied MIME type ${null==r?void 0:r.mimeType}`),a=a||function(e,t){const r=t&&Ne.exec(t),n=r&&r[1];return n?function(e,t){t=t.toLowerCase();for(const r of e)for(const e of r.extensions)if(e.toLowerCase()===t)return r;return null}(e,n):null}(t,i),u=u||(a?`matched url ${i}`:""),a=a||Ye(t,s),u=u||(a?`matched MIME type ${s}`:""),a=a||function(e,t){if(!t)return null;for(const r of e)if("string"==typeof t){if(je(t,r))return r}else if(ArrayBuffer.isView(t)){if(Ge(t.buffer,t.byteOffset,r))return r}else if(t instanceof ArrayBuffer&&Ge(t,0,r))return r;return null}(t,e),u=u||(a?`matched initial data ${Fe(e)}`:""),null!=r&&r.fallbackMimeType&&(a=a||Ye(t,null==r?void 0:r.fallbackMimeType),u=u||(a?`matched fallback MIME type ${s}`:"")),u&&ke.log(1,`selectLoader selected ${null===(l=a)||void 0===l?void 0:l.name}: ${u}.`),a}(e,o,r,n);if(!(s||null!=r&&r.nothrow))throw new Error(Be(e));return s}function Le(e){return!(e instanceof Response&&204===e.status)}function Be(e){const t=be(e),r=we(e);let n="No valid loader found (";n+=t?`${Ie(t)}, `:"no url provided, ",n+=`MIME type: ${r?`"${r}"`:"not provided"}, `;const o=e?Fe(e):"";return n+=o?` first bytes: "${o}"`:"first bytes: not available",n+=")",n}function Ye(e,t){for(const r of e){if(r.mimeTypes&&r.mimeTypes.includes(t))return r;if(t===`application/x.${r.id}`)return r}return null}function je(e,t){return t.testText?t.testText(e):(Array.isArray(t.tests)?t.tests:[t.tests]).some((t=>e.startsWith(t)))}function Ge(e,t,r){return(Array.isArray(r.tests)?r.tests:[r.tests]).some((r=>function(e,t,r,n){if(n instanceof ArrayBuffer)return function(e,t,r){if(r=r||e.byteLength,e.byteLength<r||t.byteLength<r)return!1;const n=new Uint8Array(e),o=new Uint8Array(t);for(let e=0;e<n.length;++e)if(n[e]!==o[e])return!1;return!0}(n,e,n.byteLength);switch(typeof n){case"function":return n(e);case"string":return n===$e(e,t,n.length);default:return!1}}(e,t,0,r)))}function Fe(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:5;return"string"==typeof e?e.slice(0,t):ArrayBuffer.isView(e)?$e(e.buffer,e.byteOffset,t):e instanceof ArrayBuffer?$e(e,0,t):""}function $e(e,t,r){if(e.byteLength<t+r)return"";const n=new DataView(e);let o="";for(let e=0;e<r;e++)o+=String.fromCharCode(n.getUint8(t+e));return o}async function Ue(t,r,n,o){!r||Array.isArray(r)||b(r)||(o=void 0,n=r,r=void 0),n=n||{};const s=be(t=await t),a=function(e,t){if(e&&!Array.isArray(e))return e;let r;if(e&&(r=Array.isArray(e)?e:[e]),t&&t.loaders){const e=Array.isArray(t.loaders)?t.loaders:[t.loaders];r=r?[...r,...e]:e}return r&&r.length?r:void 0}(r,o),u=await async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],r=arguments.length>2?arguments[2]:void 0,n=arguments.length>3?arguments[3]:void 0;if(!Le(e))return null;let o=Pe(e,t,{...r,nothrow:!0},n);if(o)return o;if(D(e)&&(o=Pe(e=await e.slice(0,10).arrayBuffer(),t,r,n)),!(o||null!=r&&r.nothrow))throw new Error(Be(e));return o}(t,a,n);return u?(o=function(e,t,r){if(r)return r;const n={fetch:De(t,e),...e};if(n.url){const e=_e(n.url);n.baseUrl=e,n.queryString=function(e){const t=e.match(Ae);return t&&t[0]}(n.url),n.filename=Ie(e),n.baseUrl=function(e){const t=e?e.lastIndexOf("/"):-1;return t>=0?e.substr(0,t):""}(e)}return Array.isArray(n.loaders)||(n.loaders=null),n}({url:s,_parse:Ue,loaders:a},n=ie(n,u,a,s),o||null),await async function(t,r,n,o){if(function(e){i(e,"no worker provided");e.version}(t),n=ce(t.options,n),C(r)){const e=r,{ok:t,redirected:n,status:s,statusText:i,type:a,url:u}=e,l=Object.fromEntries(e.headers.entries());o.response={headers:l,ok:t,redirected:n,status:s,statusText:i,type:a,url:u}}r=await Oe(r,t,n);const s=t;if(s.parseTextSync&&"string"==typeof r)return s.parseTextSync(r,n,o);if(function(t,r){return!!y.isSupported()&&!!(e||null!=r&&r._nodeWorkers)&&t.worker&&(null==r?void 0:r.worker)}(t,n))return await E(t,r,n,o,Ue);if(s.parseText&&"string"==typeof r)return await s.parseText(r,n,o);if(s.parse)return await s.parse(r,n,o);throw i(!s.parseSync),new Error(`${t.id} loader - no parser found and worker is disabled`)}(u,t,n,o)):null}function We(e,t){if(!e)throw new Error("null row");const r={};if(t)for(let n=0;n<t.length;n++)r[t[n]]=e[n];else for(let t=0;t<e.length;t++)r[`column-${t}`]=e[t];return r}function He(e,t){if(!e)throw new Error("null row");if(t){const r=new Array(t.length);for(let n=0;n<t.length;n++)r[n]=e[t[n]];return r}return Object.values(e)}let Je;class Ve extends Array{enqueue(e){return this.push(e)}dequeue(){return this.shift()}}Je=Symbol.asyncIterator;class ze{constructor(){this._values=void 0,this._settlers=void 0,this._closed=void 0,this._values=new Ve,this._settlers=new Ve,this._closed=!1}close(){for(;this._settlers.length>0;)this._settlers.dequeue().resolve({done:!0});this._closed=!0}[Je](){return this}enqueue(e){if(this._closed)throw new Error("Closed");if(this._settlers.length>0){if(this._values.length>0)throw new Error("Illegal internal state");const t=this._settlers.dequeue();e instanceof Error?t.reject(e):t.resolve({value:e})}else this._values.enqueue(e)}next(){if(this._values.length>0){const e=this._values.dequeue();return e instanceof Error?Promise.reject(e):Promise.resolve({value:e})}if(this._closed){if(this._settlers.length>0)throw new Error("Illegal internal state");return Promise.resolve({done:!0})}return new Promise(((e,t)=>{this._settlers.enqueue({resolve:e,reject:t})}))}}class qe{constructor(e,t){if(this.schema=void 0,this.options=void 0,this.shape=void 0,this.length=0,this.rows=null,this.cursor=0,this._headers=[],this.options=t,this.schema=e,!Array.isArray(e)){this._headers=[];for(const t in e)this._headers[e[t].index]=e[t].name}}rowCount(){return this.length}addArrayRow(e,t){Number.isFinite(t)&&(this.cursor=t),this.shape="array-row-table",this.rows=this.rows||new Array(100),this.rows[this.length]=e,this.length++}addObjectRow(e,t){Number.isFinite(t)&&(this.cursor=t),this.shape="object-row-table",this.rows=this.rows||new Array(100),this.rows[this.length]=e,this.length++}getBatch(){let e=this.rows;return e?(e=e.slice(0,this.length),this.rows=null,{shape:this.shape||"array-row-table",batchType:"data",data:e,length:this.length,schema:this.schema,cursor:this.cursor}):null}}class Qe{constructor(e,t){if(this.schema=void 0,this.options=void 0,this.length=0,this.objectRows=null,this.arrayRows=null,this.cursor=0,this._headers=null,this.options=t,this.schema=e,e){this._headers=[];for(const t in e)this._headers[e[t].index]=e[t].name}}rowCount(){return this.length}addArrayRow(e,t){switch(Number.isFinite(t)&&(this.cursor=t),this._headers||(this._headers=function(e){const t=[];for(let r=0;r<e.length;r++){const e=`column-${r}`;t.push(e)}return t}(e)),this.options.shape){case"object-row-table":const r=We(e,this._headers);this.addObjectRow(r,t);break;case"array-row-table":this.arrayRows=this.arrayRows||new Array(100),this.arrayRows[this.length]=e,this.length++}}addObjectRow(e,t){switch(Number.isFinite(t)&&(this.cursor=t),this._headers||(this._headers=function(e){return Object.keys(e)}(e)),this.options.shape){case"array-row-table":const r=He(e,this._headers);this.addArrayRow(r,t);break;case"object-row-table":this.objectRows=this.objectRows||new Array(100),this.objectRows[this.length]=e,this.length++}}getBatch(){let e=this.arrayRows||this.objectRows;return e?(e=e.slice(0,this.length),this.arrayRows=null,this.objectRows=null,{shape:this.options.shape,batchType:"data",data:e,length:this.length,schema:this.schema,cursor:this.cursor}):null}}class Ze{constructor(e,t){this.schema=void 0,this.length=0,this.allocated=0,this.columns={},this.schema=e,this._reallocateColumns()}rowCount(){return this.length}addArrayRow(e){this._reallocateColumns();let t=0;for(const r in this.columns)this.columns[r][this.length]=e[t++];this.length++}addObjectRow(e){this._reallocateColumns();for(const t in e)this.columns[t][this.length]=e[t];this.length++}getBatch(){this._pruneColumns();const e=Array.isArray(this.schema)?this.columns:{};if(!Array.isArray(this.schema))for(const t in this.schema){const r=this.schema[t];e[r.name]=this.columns[r.index]}return this.columns={},{shape:"columnar-table",batchType:"data",data:e,schema:this.schema,length:this.length}}_reallocateColumns(){if(!(this.length<this.allocated)){this.allocated=this.allocated>0?this.allocated*=2:100,this.columns={};for(const e in this.schema){const t=this.schema[e],r=t.type||Float32Array,n=this.columns[t.index];if(n&&ArrayBuffer.isView(n)){const e=new r(this.allocated);e.set(n),this.columns[t.index]=e}else n?(n.length=this.allocated,this.columns[t.index]=n):this.columns[t.index]=new r(this.allocated)}}}_pruneColumns(){for(const[e,t]of Object.entries(this.columns))this.columns[e]=t.slice(0,this.length)}}const Xe={shape:void 0,batchSize:"auto",batchDebounceMs:0,limit:0,_limitMB:0};class Ke{constructor(e,t){this.schema=void 0,this.options=void 0,this.aggregator=null,this.batchCount=0,this.bytesUsed=0,this.isChunkComplete=!1,this.lastBatchEmittedMs=Date.now(),this.totalLength=0,this.totalBytes=0,this.rowBytes=0,this.schema=e,this.options={...Xe,...t}}limitReached(){var e,t;return!!(Boolean(null===(e=this.options)||void 0===e?void 0:e.limit)&&this.totalLength>=this.options.limit)||!!(Boolean(null===(t=this.options)||void 0===t?void 0:t._limitMB)&&this.totalBytes/1e6>=this.options._limitMB)}addRow(e){this.limitReached()||(this.totalLength++,this.rowBytes=this.rowBytes||this._estimateRowMB(e),this.totalBytes+=this.rowBytes,Array.isArray(e)?this.addArrayRow(e):this.addObjectRow(e))}addArrayRow(e){if(!this.aggregator){const e=this._getTableBatchType();this.aggregator=new e(this.schema,this.options)}this.aggregator.addArrayRow(e)}addObjectRow(e){if(!this.aggregator){const e=this._getTableBatchType();this.aggregator=new e(this.schema,this.options)}this.aggregator.addObjectRow(e)}chunkComplete(e){e instanceof ArrayBuffer&&(this.bytesUsed+=e.byteLength),"string"==typeof e&&(this.bytesUsed+=e.length),this.isChunkComplete=!0}getFullBatch(e){return this._isFull()?this._getBatch(e):null}getFinalBatch(e){return this._getBatch(e)}_estimateRowMB(e){return Array.isArray(e)?8*e.length:8*Object.keys(e).length}_isFull(){if(!this.aggregator||0===this.aggregator.rowCount())return!1;if("auto"===this.options.batchSize){if(!this.isChunkComplete)return!1}else if(this.options.batchSize>this.aggregator.rowCount())return!1;return!(this.options.batchDebounceMs>Date.now()-this.lastBatchEmittedMs||(this.isChunkComplete=!1,this.lastBatchEmittedMs=Date.now(),0))}_getBatch(e){if(!this.aggregator)return null;null!=e&&e.bytesUsed&&(this.bytesUsed=e.bytesUsed);const t=this.aggregator.getBatch();return t.count=this.batchCount,t.bytesUsed=this.bytesUsed,Object.assign(t,e),this.batchCount++,this.aggregator=null,t}_getTableBatchType(){switch(this.options.shape){case"array-row-table":case"object-row-table":return Qe;case"columnar-table":return Ze;case"arrow-table":if(!Ke.ArrowBatch)throw new Error("TableBatchBuilder");return Ke.ArrowBatch;default:return qe}}}Ke.ArrowBatch=void 0;const et={parse:function(e,t,r){var n=(t=t||{}).dynamicTyping||!1;if(ut(n)&&(t.dynamicTypingFunction=n,n={}),t.dynamicTyping=n,t.transform=!!ut(t.transform)&&t.transform,t.worker&&et.WORKERS_SUPPORTED){var o=newWorker();return o.userStep=t.step,o.userChunk=t.chunk,o.userComplete=t.complete,o.userError=t.error,t.step=ut(t.step),t.chunk=ut(t.chunk),t.complete=ut(t.complete),t.error=ut(t.error),delete t.worker,void o.postMessage({input:e,config:t,workerId:o.id})}var s=null;return"string"==typeof e&&(s=new nt(t)),s||(s=new r(t)),s.stream(e)},unparse:function(e,t){var r=!1,n=!0,o=",",s="\r\n",i='"',a=i+i,u=!1,l=null;!function(){if("object"==typeof t){if("string"!=typeof t.delimiter||et.BAD_DELIMITERS.filter((function(e){return-1!==t.delimiter.indexOf(e)})).length||(o=t.delimiter),("boolean"==typeof t.quotes||Array.isArray(t.quotes))&&(r=t.quotes),"boolean"!=typeof t.skipEmptyLines&&"string"!=typeof t.skipEmptyLines||(u=t.skipEmptyLines),"string"==typeof t.newline&&(s=t.newline),"string"==typeof t.quoteChar&&(i=t.quoteChar),"boolean"==typeof t.header&&(n=t.header),Array.isArray(t.columns)){if(0===t.columns.length)throw new Error("Option columns is empty");l=t.columns}void 0!==t.escapeChar&&(a=t.escapeChar+i)}}();var c=new RegExp(st(i),"g");if("string"==typeof e&&(e=JSON.parse(e)),Array.isArray(e)){if(!e.length||Array.isArray(e[0]))return f(null,e,u);if("object"==typeof e[0])return f(l||h(e[0]),e,u)}else if("object"==typeof e)return"string"==typeof e.data&&(e.data=JSON.parse(e.data)),Array.isArray(e.data)&&(e.fields||(e.fields=e.meta&&e.meta.fields),e.fields||(e.fields=Array.isArray(e.data[0])?e.fields:h(e.data[0])),Array.isArray(e.data[0])||"object"==typeof e.data[0]||(e.data=[e.data])),f(e.fields||[],e.data||[],u);throw new Error("Unable to serialize unrecognized input");function h(e){if("object"!=typeof e)return[];var t=[];for(var r in e)t.push(r);return t}function f(e,t,r){var i="";"string"==typeof e&&(e=JSON.parse(e)),"string"==typeof t&&(t=JSON.parse(t));var a=Array.isArray(e)&&e.length>0,u=!Array.isArray(t[0]);if(a&&n){for(var l=0;l<e.length;l++)l>0&&(i+=o),i+=d(e[l],l);t.length>0&&(i+=s)}for(var c=0;c<t.length;c++){var h=a?e.length:t[c].length,f=!1,g=a?0===Object.keys(t[c]).length:0===t[c].length;if(r&&!a&&(f="greedy"===r?""===t[c].join("").trim():1===t[c].length&&0===t[c][0].length),"greedy"===r&&a){for(var p=[],y=0;y<h;y++){var m=u?e[y]:y;p.push(t[c][m])}f=""===p.join("").trim()}if(!f){for(var T=0;T<h;T++){T>0&&!g&&(i+=o);var E=a&&u?e[T]:T;i+=d(t[c][E],T)}c<t.length-1&&(!r||h>0&&!g)&&(i+=s)}}return i}function d(e,t){if(null==e)return"";if(e.constructor===Date)return JSON.stringify(e).slice(1,25);e=e.toString().replace(c,a);var n="boolean"==typeof r&&r||Array.isArray(r)&&r[t]||function(e,t){for(var r=0;r<t.length;r++)if(e.indexOf(t[r])>-1)return!0;return!1}(e,et.BAD_DELIMITERS)||e.indexOf(o)>-1||" "===e.charAt(0)||" "===e.charAt(e.length-1);return n?i+e+i:e}},RECORD_SEP:String.fromCharCode(30),UNIT_SEP:String.fromCharCode(31),BYTE_ORDER_MARK:"\ufeff",BAD_DELIMITERS:["\r","\n",'"',"\ufeff"],WORKERS_SUPPORTED:!1,NODE_STREAM_INPUT:1,LocalChunkSize:10485760,RemoteChunkSize:5242880,DefaultDelimiter:",",Parser:it,ParserHandle:ot,ChunkStreamer:rt,StringStreamer:nt},tt=et;function rt(e){this._handle=null,this._finished=!1,this._completed=!1,this._input=null,this._baseIndex=0,this._partialLine="",this._rowCount=0,this._start=0,this._nextChunk=null,this.isFirstChunk=!0,this._completeResults={data:[],errors:[],meta:{}},function(e){var t=at(e);t.chunkSize=parseInt(t.chunkSize),e.step||e.chunk||(t.chunkSize=null),this._handle=new ot(t),this._handle.streamer=this,this._config=t}.call(this,e),this.parseChunk=function(e,t){if(this.isFirstChunk&&ut(this._config.beforeFirstChunk)){var r=this._config.beforeFirstChunk(e);void 0!==r&&(e=r)}this.isFirstChunk=!1;var n=this._partialLine+e;this._partialLine="";var o=this._handle.parse(n,this._baseIndex,!this._finished);if(!this._handle.paused()&&!this._handle.aborted()){var s=o.meta.cursor;this._finished||(this._partialLine=n.substring(s-this._baseIndex),this._baseIndex=s),o&&o.data&&(this._rowCount+=o.data.length);var i=this._finished||this._config.preview&&this._rowCount>=this._config.preview;if(ut(this._config.chunk)&&!t){if(this._config.chunk(o,this._handle),this._handle.paused()||this._handle.aborted())return;o=void 0,this._completeResults=void 0}return this._config.step||this._config.chunk||(this._completeResults.data=this._completeResults.data.concat(o.data),this._completeResults.errors=this._completeResults.errors.concat(o.errors),this._completeResults.meta=o.meta),this._completed||!i||!ut(this._config.complete)||o&&o.meta.aborted||(this._config.complete(this._completeResults,this._input),this._completed=!0),i||o&&o.meta.paused||this._nextChunk(),o}},this._sendError=function(e){ut(this._config.error)&&this._config.error(e)}}function nt(e){var t;e=e||{},rt.call(this,e),this.stream=function(e){return t=e,this._nextChunk()},this._nextChunk=function(){if(!this._finished){var e=this._config.chunkSize,r=e?t.substr(0,e):t;return t=e?t.substr(e):"",this._finished=!t,this.parseChunk(r)}}}function ot(e){var t,r,n,o=/^\s*-?(\d*\.?\d+|\d+\.?\d*)(e[-+]?\d+)?\s*$/i,s=/(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d\.\d+([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z))/,i=this,a=0,u=0,l=!1,c=!1,h=[],f={data:[],errors:[],meta:{}};if(ut(e.step)){var d=e.step;e.step=function(t){if(f=t,y())p();else{if(p(),!f.data||0===f.data.length)return;a+=t.data.length,e.preview&&a>e.preview?r.abort():d(f,i)}}}function g(t){return"greedy"===e.skipEmptyLines?""===t.join("").trim():1===t.length&&0===t[0].length}function p(){if(f&&n&&(T("Delimiter","UndetectableDelimiter","Unable to auto-detect delimiting character; defaulted to '"+et.DefaultDelimiter+"'"),n=!1),e.skipEmptyLines)for(var t=0;t<f.data.length;t++)g(f.data[t])&&f.data.splice(t--,1);return y()&&function(){if(f)if(Array.isArray(f.data[0])){for(var t=0;y()&&t<f.data.length;t++)f.data[t].forEach(r);f.data.splice(0,1)}else f.data.forEach(r);function r(t){ut(e.transformHeader)&&(t=e.transformHeader(t)),h.push(t)}}(),function(){if(!f||!f.data||!e.header&&!e.dynamicTyping&&!e.transform)return f;function t(t,r){var n,o=e.header?{}:[];for(n=0;n<t.length;n++){var s=n,i=t[n];e.header&&(s=n>=h.length?"__parsed_extra":h[n]),e.transform&&(i=e.transform(i,s)),i=m(s,i),"__parsed_extra"===s?(o[s]=o[s]||[],o[s].push(i)):o[s]=i}return e.header&&(n>h.length?T("FieldMismatch","TooManyFields","Too many fields: expected "+h.length+" fields but parsed "+n,u+r):n<h.length&&T("FieldMismatch","TooFewFields","Too few fields: expected "+h.length+" fields but parsed "+n,u+r)),o}var r=1;return!f.data[0]||Array.isArray(f.data[0])?(f.data=f.data.map(t),r=f.data.length):f.data=t(f.data,0),e.header&&f.meta&&(f.meta.fields=h),u+=r,f}()}function y(){return e.header&&0===h.length}function m(t,r){return function(t){return e.dynamicTypingFunction&&void 0===e.dynamicTyping[t]&&(e.dynamicTyping[t]=e.dynamicTypingFunction(t)),!0===(e.dynamicTyping[t]||e.dynamicTyping)}(t)?"true"===r||"TRUE"===r||"false"!==r&&"FALSE"!==r&&(o.test(r)?parseFloat(r):s.test(r)?new Date(r):""===r?null:r):r}function T(e,t,r,n){f.errors.push({type:e,code:t,message:r,row:n})}this.parse=function(o,s,i){var a=e.quoteChar||'"';if(e.newline||(e.newline=function(e,t){e=e.substr(0,1048576);var r=new RegExp(st(t)+"([^]*?)"+st(t),"gm"),n=(e=e.replace(r,"")).split("\r"),o=e.split("\n"),s=o.length>1&&o[0].length<n[0].length;if(1===n.length||s)return"\n";for(var i=0,a=0;a<n.length;a++)"\n"===n[a][0]&&i++;return i>=n.length/2?"\r\n":"\r"}(o,a)),n=!1,e.delimiter)ut(e.delimiter)&&(e.delimiter=e.delimiter(o),f.meta.delimiter=e.delimiter);else{var u=function(t,r,n,o,s){var i,a,u;s=s||[",","\t","|",";",et.RECORD_SEP,et.UNIT_SEP];for(var l=0;l<s.length;l++){var c=s[l],h=0,f=0,d=0;u=void 0;for(var p=new it({comments:o,delimiter:c,newline:r,preview:10}).parse(t),y=0;y<p.data.length;y++)if(n&&g(p.data[y]))d++;else{var m=p.data[y].length;f+=m,void 0!==u?m>1&&(h+=Math.abs(m-u),u=m):u=0}p.data.length>0&&(f/=p.data.length-d),(void 0===a||h>a)&&f>1.99&&(a=h,i=c)}return e.delimiter=i,{successful:!!i,bestDelimiter:i}}(o,e.newline,e.skipEmptyLines,e.comments,e.delimitersToGuess);u.successful?e.delimiter=u.bestDelimiter:(n=!0,e.delimiter=et.DefaultDelimiter),f.meta.delimiter=e.delimiter}var c=at(e);return e.preview&&e.header&&c.preview++,t=o,r=new it(c),f=r.parse(t,s,i),p(),l?{meta:{paused:!0}}:f||{meta:{paused:!1}}},this.paused=function(){return l},this.pause=function(){l=!0,r.abort(),t=t.substr(r.getCharIndex())},this.resume=function(){l=!1,i.streamer.parseChunk(t,!0)},this.aborted=function(){return c},this.abort=function(){c=!0,r.abort(),f.meta.aborted=!0,ut(e.complete)&&e.complete(f),t=""}}function st(e){return e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function it(e){var t,r=(e=e||{}).delimiter,n=e.newline,o=e.comments,s=e.step,i=e.preview,a=e.fastMode,u=t=void 0===e.quoteChar?'"':e.quoteChar;if(void 0!==e.escapeChar&&(u=e.escapeChar),("string"!=typeof r||et.BAD_DELIMITERS.indexOf(r)>-1)&&(r=","),o===r)throw new Error("Comment character same as delimiter");!0===o?o="#":("string"!=typeof o||et.BAD_DELIMITERS.indexOf(o)>-1)&&(o=!1),"\n"!==n&&"\r"!==n&&"\r\n"!==n&&(n="\n");var l=0,c=!1;this.parse=function(e,h,f){if("string"!=typeof e)throw new Error("Input must be a string");var d=e.length,g=r.length,p=n.length,y=o.length,m=ut(s);l=0;var T=[],E=[],A=[],_=0;if(!e)return N();if(a||!1!==a&&-1===e.indexOf(t)){for(var b=e.split(n),w=0;w<b.length;w++){if(A=b[w],l+=A.length,w!==b.length-1)l+=n.length;else if(f)return N();if(!o||A.substr(0,y)!==o){if(m){if(T=[],D(A.split(r)),P(),c)return N()}else D(A.split(r));if(i&&w>=i)return T=T.slice(0,i),N(!0)}}return N()}for(var v,R=e.indexOf(r,l),O=e.indexOf(n,l),S=new RegExp(st(u)+st(t),"g");;)if(e[l]!==t)if(o&&0===A.length&&e.substr(l,y)===o){if(-1===O)return N();l=O+p,O=e.indexOf(n,l),R=e.indexOf(r,l)}else if(-1!==R&&(R<O||-1===O))A.push(e.substring(l,R)),l=R+g,R=e.indexOf(r,l);else{if(-1===O)break;if(A.push(e.substring(l,O)),x(O+p),m&&(P(),c))return N();if(i&&T.length>=i)return N(!0)}else{for(v=l,l++;;){if(-1===(v=e.indexOf(t,v+1)))return f||E.push({type:"Quotes",code:"MissingQuotes",message:"Quoted field unterminated",row:T.length,index:l}),k();if(v===d-1)return k(e.substring(l,v).replace(S,t));if(t!==u||e[v+1]!==u){if(t===u||0===v||e[v-1]!==u){var M=I(-1===O?R:Math.min(R,O));if(e[v+1+M]===r){if(A.push(e.substring(l,v).replace(S,t)),l=v+1+M+g,R=e.indexOf(r,l),O=e.indexOf(n,l),m&&(P(),c))return N();if(i&&T.length>=i)return N(!0);break}var C=I(O);if(e.substr(v+1+C,p)===n){if(A.push(e.substring(l,v).replace(S,t)),x(v+1+C+p),R=e.indexOf(r,l),m&&(P(),c))return N();if(i&&T.length>=i)return N(!0);break}E.push({type:"Quotes",code:"InvalidQuotes",message:"Trailing quote on quoted field is malformed",row:T.length,index:l}),v++}}else v++}if(m&&(P(),c))return N();if(i&&T.length>=i)return N(!0)}return k();function D(e){T.push(e),_=l}function I(t){var r=0;if(-1!==t){var n=e.substring(v+1,t);n&&""===n.trim()&&(r=n.length)}return r}function k(t){return f||(void 0===t&&(t=e.substr(l)),A.push(t),l=d,D(A),m&&P()),N()}function x(t){l=t,D(A),A=[],O=e.indexOf(n,l)}function N(e,t){return{data:t?T[0]:T,errors:E,meta:{delimiter:r,linebreak:n,aborted:c,truncated:!!e,cursor:_+(h||0)}}}function P(){s(N(void 0,!0)),T=[],E=[]}},this.abort=function(){c=!0},this.getCharIndex=function(){return l}}function at(e){if("object"!=typeof e||null===e)return e;var t=Array.isArray(e)?[]:{};for(var r in e)t[r]=at(e[r]);return t}function ut(e){return"function"==typeof e}nt.prototype=Object.create(nt.prototype),nt.prototype.constructor=nt;const{ChunkStreamer:lt}=tt;function ct(e){e=e||{},lt.call(this,e),this.textDecoder=new TextDecoder(this._config.encoding),this.stream=async function(e){this._input=e;try{for await(const t of e)this.parseChunk(this.getStringChunk(t));this._finished=!0,this.parseChunk("")}catch(e){this._sendError(e)}},this._nextChunk=function(){},this.getStringChunk=function(e){return"string"==typeof e?e:this.textDecoder.decode(e,{stream:!0})}}ct.prototype=Object.create(lt.prototype),ct.prototype.constructor=ct;const ht="object-row-table",ft={id:"csv",module:"csv",name:"CSV",version:"4.1.1",extensions:["csv","tsv","dsv"],mimeTypes:["text/csv","text/tab-separated-values","text/dsv"],category:"table",parse:async(e,t)=>dt((new TextDecoder).decode(e),t),parseText:(e,t)=>dt(e,t),parseInBatches:function(e,t){var r;"auto"===(t={...t}).batchSize&&(t.batchSize=4e3);const n={...ft.options.csv,...null===(r=t)||void 0===r?void 0:r.csv},o=new ze;let s=!0,i=null,a=null,u=null;const l={...n,header:!1,download:!1,chunkSize:5242880,skipEmptyLines:!1,step(e){let r=e.data;if(n.skipEmptyLines&&""===r.flat().join("").trim())return;const l=e.meta.cursor;if(s&&!i&&("auto"===n.header?gt(r):Boolean(n.header)))return void(i=r.map(pt()));s&&(s=!1,i||(i=yt(n.columnPrefix,r.length)),u=function(e,t){const r=t?{}:[];for(let n=0;n<e.length;n++){const o=t&&t[n]||n;switch(typeof e[n]){case"number":case"boolean":r[o]={name:String(o),index:n,type:Float32Array};break;default:r[o]={name:String(o),index:n,type:Array}}}return r}(r,i)),n.optimizeMemoryUsage&&(r=JSON.parse(JSON.stringify(r)));const c=n.shape||ht;a=a||new Ke(u,{shape:c,...t});try{a.addRow(r);const e=a&&a.getFullBatch({bytesUsed:l});e&&o.enqueue(e)}catch(e){o.enqueue(e)}},complete(e){try{const t=e.meta.cursor,r=a&&a.getFinalBatch({bytesUsed:t});r&&o.enqueue(r)}catch(e){o.enqueue(e)}o.close()}};return tt.parse(e,l,ct),o},options:{csv:{shape:ht,optimizeMemoryUsage:!1,header:"auto",columnPrefix:"column",quoteChar:'"',escapeChar:'"',dynamicTyping:!0,comments:!1,skipEmptyLines:!0,delimitersToGuess:[",","\t","|",";"]}}};async function dt(e,t){const r={...ft.options.csv,...null==t?void 0:t.csv},n=function(e){return tt.parse(e,{download:!1,dynamicTyping:!0,preview:1}).data[0]}(e),o="auto"===r.header?gt(n):Boolean(r.header),s={...r,header:o,download:!1,transformHeader:o?pt():void 0,error:e=>{throw new Error(e)}},i=tt.parse(e,s),a=i.data,u=i.meta.fields||yt(r.columnPrefix,n.length),l=r.shape||ht;switch(l){case"object-row-table":return{shape:"object-row-table",data:a.map((e=>Array.isArray(e)?We(e,u):e))};case"array-row-table":return{shape:"array-row-table",data:a.map((e=>Array.isArray(e)?e:He(e,u)))};default:throw new Error(l)}}function gt(e){return e&&e.every((e=>"string"==typeof e))}function pt(){const e=new Set;return t=>{let r=t,n=1;for(;e.has(r);)r=`${t}.${n}`,n++;return e.add(r),r}}function yt(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;const r=[];for(let n=0;n<t;n++)r.push(`${e}${n+1}`);return r}var mt={},Tt={};function Et(e){return new Function("d","return {"+e.map((function(e,t){return JSON.stringify(e)+": d["+t+'] || ""'})).join(",")+"}")}function At(e){var t=Object.create(null),r=[];return e.forEach((function(e){for(var n in e)n in t||r.push(t[n]=n)})),r}function _t(e,t){var r=e+"",n=r.length;return n<t?new Array(t-n+1).join(0)+r:r}var bt=function(e){var t=new RegExp('[",\n\r]'),r=e.charCodeAt(0);function n(e,t){var n,o=[],s=e.length,i=0,a=0,u=s<=0,l=!1;function c(){if(u)return Tt;if(l)return l=!1,mt;var t,n,o=i;if(34===e.charCodeAt(o)){for(;i++<s&&34!==e.charCodeAt(i)||34===e.charCodeAt(++i););return(t=i)>=s?u=!0:10===(n=e.charCodeAt(i++))?l=!0:13===n&&(l=!0,10===e.charCodeAt(i)&&++i),e.slice(o+1,t-1).replace(/""/g,'"')}for(;i<s;){if(10===(n=e.charCodeAt(t=i++)))l=!0;else if(13===n)l=!0,10===e.charCodeAt(i)&&++i;else if(n!==r)continue;return e.slice(o,t)}return u=!0,e.slice(o,s)}for(10===e.charCodeAt(s-1)&&--s,13===e.charCodeAt(s-1)&&--s;(n=c())!==Tt;){for(var h=[];n!==mt&&n!==Tt;)h.push(n),n=c();t&&null==(h=t(h,a++))||o.push(h)}return o}function o(t,r){return t.map((function(t){return r.map((function(e){return i(t[e])})).join(e)}))}function s(t){return t.map(i).join(e)}function i(e){return null==e?"":e instanceof Date?(o=(r=e).getUTCHours(),s=r.getUTCMinutes(),i=r.getUTCSeconds(),a=r.getUTCMilliseconds(),isNaN(r)?"Invalid Date":((n=r.getUTCFullYear())<0?"-"+_t(-n,6):n>9999?"+"+_t(n,6):_t(n,4))+"-"+_t(r.getUTCMonth()+1,2)+"-"+_t(r.getUTCDate(),2)+(a?"T"+_t(o,2)+":"+_t(s,2)+":"+_t(i,2)+"."+_t(a,3)+"Z":i?"T"+_t(o,2)+":"+_t(s,2)+":"+_t(i,2)+"Z":s||o?"T"+_t(o,2)+":"+_t(s,2)+"Z":"")):t.test(e+="")?'"'+e.replace(/"/g,'""')+'"':e;var r,n,o,s,i,a}return{parse:function(e,t){var r,o,s=n(e,(function(e,n){if(r)return r(e,n-1);o=e,r=t?function(e,t){var r=Et(e);return function(n,o){return t(r(n),o,e)}}(e,t):Et(e)}));return s.columns=o||[],s},parseRows:n,format:function(t,r){return null==r&&(r=At(t)),[r.map(i).join(e)].concat(o(t,r)).join("\n")},formatBody:function(e,t){return null==t&&(t=At(e)),o(e,t).join("\n")},formatRows:function(e){return e.map(s).join("\n")},formatRow:s,formatValue:i}}(","),wt=(bt.parse,bt.parseRows),vt=(bt.format,bt.formatBody,bt.formatRows,bt.formatRow,bt.formatValue,r(2420)),Rt=r(5536),Ot=r.n(Rt);const St=/^(null|NULL|Null|NaN|\/N||)$/,Mt=[vt.DATA_TYPES.DATE,vt.DATA_TYPES.TIME,vt.DATA_TYPES.DATETIME,vt.DATA_TYPES.NUMBER,vt.DATA_TYPES.INT,vt.DATA_TYPES.FLOAT,vt.DATA_TYPES.BOOLEAN,vt.DATA_TYPES.STRING,vt.DATA_TYPES.GEOMETRY,vt.DATA_TYPES.GEOMETRY_FROM_STRING,vt.DATA_TYPES.PAIR_GEOMETRY_FROM_STRING,vt.DATA_TYPES.ZIPCODE,vt.DATA_TYPES.ARRAY,vt.DATA_TYPES.OBJECT],Ct=Ot()({boolean:null,date:null,geojson:null,integer:null,real:null,string:null,timestamp:null,point:null,array:null,object:null,geoarrow:null}),Dt=Object.keys(vt.DATA_TYPES).filter((e=>!Mt.includes(e)));function It(e){return e===Object(e)&&"function"!=typeof e&&!Array.isArray(e)}function kt(e){try{return JSON.parse(e)}catch(e){return null}}function xt(e){const{DATE:t,TIME:r,DATETIME:n,NUMBER:o,INT:s,FLOAT:i,BOOLEAN:a,STRING:u,GEOMETRY:l,GEOMETRY_FROM_STRING:c,PAIR_GEOMETRY_FROM_STRING:h,ZIPCODE:f,ARRAY:d,OBJECT:g}=vt.DATA_TYPES;switch(e){case t:return Ct.date;case r:case n:return Ct.timestamp;case i:return Ct.real;case s:return Ct.integer;case a:return Ct.boolean;case l:case c:case h:return Ct.geojson;case d:return Ct.array;case g:return Ct.object;case o:case u:case f:return Ct.string;default:return console.warn(`Unsupported analyzer type: ${e}`),Ct.string}}const Nt={[Ct.boolean]:{valid:e=>"boolean"==typeof e,parse:e=>"true"===e||"True"===e||"TRUE"===e||"1"===e},[Ct.integer]:{valid:e=>parseInt(e,10)===e,parse:e=>parseInt(e,10)},[Ct.timestamp]:{valid:(e,t)=>["x","X"].includes(t.format)?"number"==typeof e:"string"==typeof e,parse:(e,t)=>["x","X"].includes(t.format)?Number(e):e},[Ct.real]:{valid:e=>parseFloat(e)===e,parse:parseFloat},[Ct.object]:{valid:It,parse:kt},[Ct.array]:{valid:Array.isArray,parse:kt}};function Pt(e){return null!=e}function Lt(e){const t=new RegExp(St,"g");for(let r=0;r<e.length;r++)for(let n=0;n<e[r].length;n++)"string"==typeof e[r][n]&&e[r][n].match(t)&&(e[r][n]=null)}function Bt(e,t,r,n){const o=Nt[r.type];if(o){const s=e.find((e=>Pt(e[n])));if(!s||o.valid(s[n],r))return;e.forEach((e=>{null!==e[n]&&(e[n]=o.parse(e[n],r),t>-1&&It(e[t])&&("properties",e[t].hasOwnProperty("properties"))&&(e[t].properties[r.name]=e[n]))}))}}function Yt(e,t){const r=t.findIndex((e=>"_geojson"===e.name));return t.forEach(Bt.bind(null,e,r)),e}function jt(e,t){let r,n;if("string"==typeof e){const t=wt(e);if(!Array.isArray(t)||t.length<2)throw new Error("process Csv Data Failed: CSV is empty");n=t[0],r=t.slice(1)}else Array.isArray(e)&&e.length&&(r=e,n=t,Array.isArray(n)||(n=e[0],r=e.slice(1)));if(!r||!n)throw new Error("invalid input passed to processCsvData");Lt(r);const o=function(e,t){const r=vt.Analyzer.computeColMeta(e,[{regex:/.*geojson|all_points/g,dataType:"GEOMETRY"},{regex:/.*census/g,dataType:"STRING"}],{ignoredDataTypes:Dt}),{fieldByIndex:n}=function(e){return e.reduce(((e,t,r)=>{const{allNames:n}=e;let o=t;if(n.includes(t)){let e=0;for(;n.includes(`${t}-${e}`);)e++;o=`${t}-${e}`}return e.fieldByIndex[r]=o,e.allNames.push(o),e}),{allNames:[],fieldByIndex:[]})}(t);return t.map(((t,o)=>{const s=n[o],i=r.find((e=>e.key===t));let a=i?.type||"STRING";const u=i?.format||"";return a===vt.DATA_TYPES.STRING&&(a=e.some((e=>{return!!(t=e[s])&&!(t.length<10||t.length%2!=0)&&!(!t.startsWith("00")&&!t.startsWith("01"))&&/^[0-9a-fA-F]+$/.test(t.slice(2));var t}))?vt.DATA_TYPES.GEOMETRY:a),{name:s,id:s,displayName:s,format:u,fieldIdx:o,type:xt(a),analyzerType:a,valueAccessor:e=>t=>e.valueAt(t.index,o)}}))}(function(e){let{fields:t,rows:r,sampleCount:n=50}=e;const o=Math.min(n,r.length),s=function(e,t,r){e=+e,t=+t,r=(o=arguments.length)<2?(t=e,e=0,1):o<3?1:+r;for(var n=-1,o=0|Math.max(0,Math.ceil((t-e)/r)),s=new Array(o);++n<o;)s[n]=e+n*r;return s}(0,o,1).map((e=>({})));return t.forEach(((e,t)=>{let n=0,i=0;for(;i<o;)if(n>=r.length)s[i][e]=null,i++;else if(Pt(r[n][t])){const o=r[n][t];s[i][e]="string"==typeof o?o.trim():o,i++,n++}else n++})),s}({fields:n,rows:r}),n);return{fields:o,rows:Yt(r,o)}}const Gt=async e=>function(e){if(!Array.isArray(e))return null;if(!e.length)return{fields:[],rows:[]};const t=Object.keys(e[0]),r=e.map((e=>t.map((t=>e[t]))));return Lt(r),jt(r,t)}((await Ue(e,ft)).data)})(),n})()));